# aave v3 indexer - Pipes SDK ðŸ¦‘

Stream blockchain data from SQD's Portal, transform it however you need, and send it anywhere. Use the built-ins, write your own, or mix bothâ€”everything chains together with `pipe()`.

## Overview

This indexer tracks Aave V3 USDC deposits and withdrawals on Ethereum mainnet, providing real-time metrics on:
- Supply events (USDC deposits â†’ aUSDC minting)
- Withdraw events (aUSDC burning â†’ USDC withdrawals)
- Cumulative USDC deposits over time
- Daily mint/burn volumes

![USDC Deposits Mints & Burns](./chart-screenshot.png)

## Data Metrics

As of February 3, 2026:
- **Cumulative USDC Deposits**: 4.15B (verified against on-chain aUSDC supply: 4.19B)
- **Total Supply Events**: 96.04B USDC processed
- **Total Withdraw Events**: 91.89B USDC processed
- **Data Range**: January 27, 2023 - Present
- **Events Indexed**: 764,249 events across 1,104 days

## Running the pipeline

### Using Docker Compose

```bash
docker compose --profile with-pipeline up -d
```

### Using Node.js

#### 1. Install dependencies
_If starting a new project using the Pipes CLI, this step is already handled for you_
```bash
bun install
```

#### 2. Start  ClickHouse (Docker)
```bash
docker compose up -d
```


#### 3. Start the pipeline
```bash
bun run dev
```


## Build and deploy
You can deploy your pipelines built with the Pipes SDK to any cloud provider that supports Node.js.

#### Docker
For providers that support containerization, you can use the `Dockerfile` or `docker-compose.yml` provided with this template to deploy your pipeline.
```bash
docker build -t aave-v3-indexer . 

# To run the pipeline using docker compose, use the `--profile with-pipeline` flag.
docker compose --profile with-pipeline up -d
```

#### Node.js
You can also deploy your pipeline that provides node.js runtime, by using the `package.json` file provided with this template.
```bash
bun build
```


## Pipeline metrics
In order to track pipeline metrics the Pipes SDK provides a metrics server along with a UI dashboard.

#### 1. Enable the metrics server in the pipeline's Portal source
Enable the metrics server in the pipeline's Portal source. 
```ts
import { evmPortalSource } from '@subsquid/pipes/evm'
import { metricsServer } from '@subsquid/pipes/metrics/node'

const pipeline = evmPortalSource({
    portal: 'https://portal.sqd.dev/datasets/ethereum-mainnet',
    /**
     * Enables the metrics server.
     * Default port is 9090, but you can change it by passing a custom port.
     */
    metrics: metricsServer(/* { port: 9091 } */), 
})
    .pipe({
        /**
         * `profiler` is an optional parameter to attach a specific id to this transformer.
         * Although not required, it's recommended for a better granularity of the metrics collection.
         */
        profiler: { id: 'my transformer' }, 
        transform: (data) => {/* your transform code */}
    })
```

#### 2. Run the Pipe UI dashboard
This will start the Pipe UI dashboard at http://localhost:3000. _Learn more about the Pipe UI [here](https://beta.docs.sqd.dev/en/sdk/pipes-sdk/evm.autogenerated/reference/pipe-ui)_
```bash
npx @sqd-pipes/pipe-ui
```

#### 3. Custom metrics
Need to track custom metrics? Explore the [custom metrics section](https://beta.docs.sqd.dev/en/sdk/pipes-sdk/evm.autogenerated/advanced/quality-of-life#custom-metrics) in the Pipes SDK docs.


## Visualization

This project includes a Chart.js visualization (`usdc-deposits-chart.html`) that displays:
- **Blue line**: Cumulative USDC deposits (billions) on the right Y-axis
- **Green bars**: Daily USDC deposit mints (millions) on the left Y-axis
- **Red bars**: Daily USDC deposit burns (millions, shown as negative) on the left Y-axis

Open `usdc-deposits-chart.html` in your browser to view the interactive chart.

## Going deeper
Check our [documentation](https://beta.docs.sqd.dev/en/sdk/pipes-sdk) to learn more about the Pipes SDK and Portal.
